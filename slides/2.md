## 前端开发的历史演变

--

### 什么是前端开发

![](images/frontend.png)

- 前端：针对浏览器的开发，代码在浏览器运行
- 后端：针对服务器的开发，代码在服务器运行

--

### 简单明快的早期时代

前后端开发是一体的，前端代码是后端代码的一部分

1. 后端收到浏览器的请求
2. 由JSP或PHP生成静态页面
3. 发送到浏览器

Note:互联网早期web 1.0时代，基本上是服务端给什么浏览器就展现什么，展现的内容完全控制在后端，好处就是简单明快，后端在本地起一个服务就可以开发，弊端是对前端不友好，调试麻烦，页面中充斥着大量的业务逻辑，可维护性不好

--

### 后端为主的MVC时代

为了降低复杂度，以后端为出发点进行了分层设计

- Model（模型层）：提供、保存、处理数据
- Controller（控制层）：路由调度，实现业务逻辑
- View（视图层）：展示数据，提供用户界面

> 此时的前端只是后端 MVC 的 V

Note:分层以后让开发者知道什么代码应该写在什么地方，可维护性得到很大提升

--

以 PHP 框架 Laravel 为例

![](images/laravel-mvc.png)


Note:此时前端工程师的角色实际上是模板工程师，负责编写页面模板。后端代码读取模板，替换变量，渲染出页面，来看一个具体的模板

--

典型的 PHP 模板

``` html
<html>
  <head>
    <title></title>
  </head>
  <body>
    <h1>用户 {{ $user->id }}</h1>
    <ul>
      <li>姓名: {{ $user->name }}</li>
      <li>年龄: {{ $user->age }}</li>
      <li>性别: {{ $user->gender }}</li>
    </ul>
  </body>
</html>
```
Note:这种分工存在一些问题，主要有两种协作模式：一种是前端写静态的demo，写好后让后端去套模板，后端有可能套错，套完后还需要前端确认。另一种方式是前端负责所有后端View层的开发，这对前端要求比较高，需要懂模板语法和一点后端语言。有时候职责会纠缠不清，应该在控制器中的出现的业务逻辑跑到了模板中。两种方式都增加了沟通成本，影响了开发效率

--

### SPA时代

2005年Ajax技术诞生，前端不再是后端的模板，可以处理各种数据，前端交互和体验越来越丰富，于是出现了SPA

> SPA = Single Page Application
 
- 2004年：Gmail
- 2005年：Google 地图

代表框架有：jQuery、YUI、EXT、Dojo

--

前后端架构的改变

![](images/arch.png)

--

从开发页面，变成了开发"应用"

![](images/arch2.png)

Note:此时前后端的分工非常清晰，协作的关键点是Ajax接口。复杂度从服务端渐渐移到了浏览器端，前端代码量也变得越来越大，如何组织JS代码，数据如何与View层进行绑定，这些都是问题，而jQuery, Yui等只解决了Javascript工具库的问题, 但工程化需求还没有好的解决方案

--

### 前端为主的MV*时代

![](images/mvc-simple.png)

- View 负责数据展示(html+css) 
- Controller 实现服务和逻辑控制(监听事件和请求)
- Model 获取数据并对外提供数据

代表框架有：Backbone、Ember、Knockout、Angular

Note:为了降低前端开发复杂度，涌现出了一大批的MVC或MVVM的框架，这是一个百团大战的时代，各种框架纷纷借鉴后端mvc的架构将前端进行了分层设计。例如ember受Rails全栈框架的启发, 逐步发展成前端领域的另一个Rails。Angular把Java中的一些设计思想带到了前端

--

Angular

Google 公司推出的 Angular 是最流行的 MVVM 前端框架

最大的亮点是双向数据绑定

![](images/angular.png)

Note:Angular是一个大而全的框架，包含了模板、双向数据绑定、路由、模块化、服务、过滤器、依赖注入等特性。自带了很多ng指令，功能非常强大，方便了我们编写前端模板

--

双向数据绑定

![](images/mvvm.png)

- view 绑定 view-model，视图与数据模型强耦合
- 数据的变化实时反映在 view 上，不需要手动处理

Note:双向数据绑定改变了我们操作DOM的方式

--

例子
<iframe width="800" height="350" data-src="/demos/angular-demo/index.html"></iframe>

--

代码
```javascript
<div ng-app="">
  <p>
    姓名 :
    <input
      type="text"
      ng-model="name"
      placeholder="在这里输入您的大名"
    >
  </p>
  <h1>你好，{{name}}</h1>
</div>
```

Note:阿里云选购例子

--

MVC的局限性

![](images/mvc-complex.png)

Note:上面的MVC(View、Model、Controller是1:1:1的关系)只是一种理想状态。现实中的程序往往是多视图，多模型。更严重的是视图与模型之间还可以是多对多的关系。也就是说，单个视图的数据可以来自多个模型，单个模型更新是需要通知多个视图，用户在视图上的操作可以对多个模型造成影响。可以想象最致命的后果是，视图与模型之间相互更新的死循环。如此的混乱会产生很多的问题

--

![](images/go-die.png)

Note: 要新添加一个功能或特性复杂度会成级数增长，调试代码也会很困难。假设在一个复杂的MVC的架构中，有多个controller可以修改model，而开发时model的数据产出并非如你所愿，你很难判断出是哪个controller出的错，只能使用控制变量法进行调试


